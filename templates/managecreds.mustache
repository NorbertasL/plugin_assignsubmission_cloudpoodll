<div class="assign_submission_cloudpoodll_credsmanager">
    {{#apiuser}}<a href="#" class="cloudpoodll_poke_creds">{{#str}}fillcredentials, assignsubmission_cloudpoodll{{/str}}</a>{{/apiuser}}
    {{^apiuser}}<a href="#" class="cloudpoodll_pop_cb" data-planpriceid="Poodll-Free-Trial-USD-Daily">{{#str}}freetrial, assignsubmission_cloudpoodll{{/str}}</a>{{/apiuser}}
</div>
{{^element.frozen}}
    {{#js}}
        require(['jquery'],function($) {
            //set up checkout links

            $(".assign_submission_cloudpoodll_credsmanager .cloudpoodll_pop_cb").on("click", function() {
                event.preventDefault();
                var that = this;
                $.getScript('https://js.chargebee.com/v2/chargebee.js', function(){
                    var chargebee = Chargebee.init({'site': '{{poodllcbsite}}', isItemsModel: true});
                    var cart = chargebee.getCart()
                    var planPriceId = $(that).data('planpriceid');//Poodll-Free-Trial-USD-Daily
                    var planPriceQuantity = 1
                    var product = chargebee.initializeProduct(planPriceId, planPriceQuantity)
                    cart.replaceProduct(product);

                    // Passing values for custom fields
                    //product.setCustomData({startsiteurl: "{{{wwwroot}}}"});

                    // Opening the checkout
                    cart.proceedToCheckout();
                });
            });

            //set up fetch from elsewhere
            $(".assign_submission_cloudpoodll_credsmanager .cloudpoodll_poke_creds").on("click", function() {
                event.preventDefault();
                var apiuser = document.getElementById('id_s_assignsubmission_cloudpoodll_apiuser');
                var apisecret = document.getElementById('id_s_assignsubmission_cloudpoodll_apisecret');
                apiuser.value='{{{apiuser}}}';
                apisecret.value='{{{apisecret}}}';
            });
        });
    {{/js}}
{{/element.frozen}}