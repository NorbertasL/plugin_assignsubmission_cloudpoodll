{"version":3,"file":"standardtranscript.min.js","sources":["../src/standardtranscript.js"],"sourcesContent":["define(['jquery','core/log','core/str','core/ajax','core/notification'],\n    function($,log,str,Ajax,notification) {\n    \"use strict\"; // jshint ;_;\n\n    log.debug('Standard Transcript: initialising');\n\n    return {\n\n        init: function(opts){\n\n            var component= opts['component'];\n            var playerid= opts['playerid'];\n            var containerid= opts['containerid'];\n            var cssprefix= opts['cssprefix'];\n            var config={};\n            config.settings ={};\n            if(playerid && $('#' + playerid).length) {\n                config.component = component;\n                config.container =$('#' + containerid)\n                config.prefix = cssprefix;\n                config.player = $('#' + playerid)[0];\n                config.transcripturl = opts['transcripturl'];\n                config.title = M.util.get_string('transcripttitle',component);\n                config.assignmentid = opts['assignmentid'];\n                this.fetch_transcript(config);\n            }\n        },\n\n        fetch_transcript: function(config){\n            var that = this;\n            var header = '<header class=\"' + config.prefix + '-header\">' +config.title+'</header>';\n            config.container.load(config.transcripturl,function(){\n                config.container.prepend(header);\n                //uncomment this to show the fetch corrections button\n               // that.prepare_corrections_button(config);\n            });\n        },\n\n        prepare_corrections_button: function(config){\n            var that = this;\n            var button = '<a class=\"btn btn-standard\" href=\"#\">fetch corrections</a>';\n            config.button =  config.container.append(button);\n            $(config.button).on('click',function(){that.fetch_corrections(config)});\n        },\n\n        fetch_corrections: function(config){\n\n            //do the check\n            var text = config.container.text();\n            //but quit if its empty\n            if(!text || text==='' || text.trim()===''){\n                return;\n            }\n\n            Ajax.call([{\n                methodname: 'assignsubmission_cloudpoodll_check_grammar',\n                args: {\n                    assignmentid: config.assignmentid,\n                    text: text\n\n                },\n                done: function (ajaxresult) {\n\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        config.container.append(payloadobject.corrections);\n                    }else{\n                        //something went wrong\n                        config.container.append('could not fetch corrections');\n                        log.debug('result not fetched');\n                    }\n\n                },\n                fail: notification.exception\n            }]);\n        }\n\n    };//end of return object\n});"],"names":["define","$","log","str","Ajax","notification","debug","init","opts","component","playerid","containerid","cssprefix","config","length","container","prefix","player","transcripturl","title","M","util","get_string","assignmentid","fetch_transcript","header","load","prepend","prepare_corrections_button","that","this","button","append","on","fetch_corrections","text","trim","call","methodname","args","done","ajaxresult","payloadobject","JSON","parse","corrections","fail","exception"],"mappings":"AAAAA,yDAAO,CAAC,SAAS,WAAW,WAAW,YAAY,sBAC/C,SAASC,EAAEC,IAAIC,IAAIC,KAAKC,qBAGxBH,IAAII,MAAM,qCAEH,CAEHC,KAAM,SAASC,UAEPC,UAAWD,KAAI,UACfE,SAAUF,KAAI,SACdG,YAAaH,KAAI,YACjBI,UAAWJ,KAAI,UACfK,OAAO,CACXA,SAAiB,IACdH,UAAYT,EAAE,IAAMS,UAAUI,SAC7BD,OAAOJ,UAAYA,UACnBI,OAAOE,UAAWd,EAAE,IAAMU,aAC1BE,OAAOG,OAASJ,UAChBC,OAAOI,OAAShB,EAAE,IAAMS,UAAU,GAClCG,OAAOK,cAAgBV,KAAI,cAC3BK,OAAOM,MAAQC,EAAEC,KAAKC,WAAW,kBAAkBb,WACnDI,OAAOU,aAAef,KAAI,kBACrBgB,iBAAiBX,UAI9BW,iBAAkB,SAASX,YAEnBY,OAAS,kBAAoBZ,OAAOG,OAAS,YAAaH,OAAOM,MAAM,YAC3EN,OAAOE,UAAUW,KAAKb,OAAOK,eAAc,WACvCL,OAAOE,UAAUY,QAAQF,YAMjCG,2BAA4B,SAASf,YAC7BgB,KAAOC,KAEXjB,OAAOkB,OAAUlB,OAAOE,UAAUiB,OADrB,8DAEb/B,EAAEY,OAAOkB,QAAQE,GAAG,SAAQ,WAAWJ,KAAKK,kBAAkBrB,YAGlEqB,kBAAmB,SAASrB,YAGpBsB,KAAOtB,OAAOE,UAAUoB,OAExBA,MAAe,KAAPA,MAA2B,KAAdA,KAAKC,QAI9BhC,KAAKiC,KAAK,CAAC,CACPC,WAAY,6CACZC,KAAM,CACFhB,aAAcV,OAAOU,aACrBY,KAAMA,MAGVK,KAAM,SAAUC,gBAERC,cAAgBC,KAAKC,MAAMH,YAC3BC,cACA7B,OAAOE,UAAUiB,OAAOU,cAAcG,cAGtChC,OAAOE,UAAUiB,OAAO,+BACxB9B,IAAII,MAAM,wBAIlBwC,KAAMzC,aAAa0C"}